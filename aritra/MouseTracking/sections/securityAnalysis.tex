\section{Security Analysis}
\label{sec:securityAnalysis}

%In this section, we analyze the security of \name by modeling the interaction between the user, host, and the remote server.


%\subsection{Modelling the Protocol}
%\label{sec:securityAnalysis:modelling}

%\subsubsection{Modelling the user behavior}
%\label{sec:securityAnalysis:modelling:user}

\myparagraph{Modelling the user behavior} Correctly understanding the user behavior is critical as \name focuses on securing user interaction with the remote server. In Section~\ref{sec:systemDesign:userAttention}, we explain secure attention sequence (SAS) (Section~\ref{sec:systemDesign:userAttention:sas}) that \name uses to provide visual cues. SAS enables use to i) follow the legitimate mouse pointer, and ii) recognize which part of the screen is overlaid by the \device. This is achieved by dimming out the screen except for the pointer and the UI overlay. We assume that the user behaves reasonably, hence the SAS mechanism is sufficient to isolate the trusted part of the screen (\device overlay) from the untrusted part of the screen. We also agree that system like \name may not achieve absolute security as the user may choose to ignore all visual cues made by the \device and choose to follow the untrusted notification from the host. Therefore, as long as the user does not get influenced by the information provided in the untrusted part of the screen and modifies her input, the \name remains secure. %The formal security analysis is provided in Appendix~\ref{appendix:security}.


\subsection{Integrity}
\label{sec:securityAnalysis:integrity}

%From the theorem that is described in Section~\ref{sec:securityAnalysis:modelling}, we can prove that \name provide input integrity. The UI overlay ensures that the user has output integrity, i.e., all the sensitive information sent by the server cannot be manipulated by the host. Also, the \device signs all the input provided by the user. From Theorem~\ref{theorem:th3}, we can conclude that \name provides IO integrity as long as we assume that the user does not get influenced by any information shown in the non-overlaid part of the screen (Discussed in Section~\ref{sec:securityAnalysis:modelling:user}). \name additionally protects against replay attack as the form also contains nonce to ensure freshness.  

In Appendix~\ref{appendix:security:protocol}, we model \name as a finite state machine (FSM) as seen in Figure~\ref{fig:fsm}. Definition~\ref{def:inputIntegrity} and~\ref{def:outputIntegrity} provides the formal definition of input and output integrity respectively. In Theorem~\ref{theorem:th1}, ~\ref{theorem:th2}. and ~\ref{theorem:th3} we prove that as long as user reports everything that she sees on display to the remote server alongside her input over an authenticated channel, input integrity could be achieved. \name ensures output integrity the \device overlays the sensitive UI on the screen. By doing so, \name also ensures input integrity.  


\myparagraph{Attack on the mouse pointer tracking and overlay} The attacker may try to defeat \name mouse pointer tracking and overlay mechanism that is described in Section~\ref{sec:systemDesign:analysis} by introducing a mouse pointer that is visually more detectable by the user. Note that the \device overlaid mouse pointer is quite prominent and hard to miss. One can visualize it as an arms race between the attacker and the \device to grab the attention of the user. But, we can argue that this is a suboptimal strategy for the attacker as both of the pointers will be visible on the screen that can cause suspicion by the user. Hence, we can conclude that executing clickjacking-like attacks are not possible in \name.

\myparagraph{Replay attack} All the sensitive UI elements from the remote server contain freshness value (nonce) alongside the signature. Hence, the replay attack is not possible.

\myparagraph{Not rendering QR code} The host may deny sending the QR code over the HDMI channel. This considers as a denial of service as the \device can not observe and decode the encoded UI. As the remote server only accepts signed inputs from the \device corresponding to the sensitive UI, the host can not submit arbitrary input values to the remote server.

\subsection{Confidentiality}

\myparagraph{Side-channel leakages} Even though, the \device ensures that no mouse, keyboard data reach to the untrusted host when the user executes some operation over the overlaid UI, one can not rule out side-channel leakages. One example could be the amount of time that the user spends or the entry/exit position of the mouse pointer may reveal some information about the input. However, for fixed length inputs such as the pin codes or credit card details do not leak any information about the input.

\subsection{Fast-switching}
The attacker can show QR-code, so the device renders the overlay. The host removes QR-code (and the device removes the overlay), then device shows a fake render that mimics the one from the device to show some malicious views. This can be repeated many times.

\subsection{Hover activity}
The attacker wants to learn what button did the user click by tracking the cursor movement. This should be prevented if the device does not send any event to the host when inside the overlay.

\subsection{Early form submission and \red{clickjacking}}

\subsection{Attacks toward \device}


\iffalse
\subsection{Protection against phishing attacks}
\subsection{Keyboard Manipulation Attacks and Defenses}
\subsubsection{Change user selected values}


\subsection{Mouse Manipulation Attacks and Defenses}
\subsubsection{Changing mouse position}
Changing the mouse position can be detected by the device as the device expects to find it in the location that the user provides. 
\subsubsection{Removing the mouse completely}
This is detectable by the \device as the \device no longer finds the mouse pointer in the screen at the designated position.  
\subsubsection{Add mouse cursor to confuse users}

\subsection{UI Manipulation Attacks and Defenses}
\subsubsection{Manipulate the position of the UI elements on the screen}
\fi