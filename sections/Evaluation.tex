\begin{table*}[h]
\scriptsize
\centering
\resizebox{\textwidth}{!}{
  \begin{tabular}{l | l | c  c  c  c | c  c  c  c | c c} 
      
    \multicolumn{2}{c}{\multirow{2}{*}{Security Requirements} \ldelim\{{2}{-10mm}[]} & \multicolumn{4}{c}{} & \multicolumn{4}{c}{\cellcolor{Gray}\textbf{R1}} & \multicolumn{2}{c}{} \\
    %\multicolumn{2}{c}{} & \multicolumn{4}{c}{} & \multicolumn{3}{c}{} & \multicolumn{3}{c}{} \\
    %\multicolumn{2}{c}{} & \multicolumn{8}{c}{} & \multicolumn{2}{c}{} \\
    \multicolumn{2}{c}{} & \multicolumn{4}{c|}{\cellcolor{Gray}\textbf{R4}} & \multicolumn{3}{c}{\cellcolor{Gray}\textbf{R2}} & \multicolumn{1}{c}{} & \multicolumn{2}{c}{\cellcolor{Gray}\textbf{R3a/b}} \\ \hline
   \multirow{4}{*}{Category}
   & \multicolumn{1}{c|}{\multirow{4}{*}{Solutions}} &\multicolumn{4}{c|}{Trust Assumption} & \multicolumn{4}{c| }{IO Security Features} & \multicolumn{2}{c} {Usability}\\  \cline{3-12}
   & &\multicolumn{2}{c|}{Hardware} & \multicolumn{2}{c|}{Software} & \multicolumn{3}{c|}{Input} & \multicolumn{1}{c|}{Output} & \\  \cline{3-10}
   %\rowcolor{Gray}
    & & Requires & \multicolumn{1}{c|}{External} & Isolated & Hypervisor/ & \multirow{2}{*}{Keyboard} & \multirow{2}{*}{Pointer} & \multicolumn{1}{c|}{\multirow{2}{*}{Touch}} & \multirow{2}{*}{Display} & No & \multirow{2}{*}{PnP}\\
   \cellcolor{white} & & TEE & \multicolumn{1}{c|}{trusted HW} & API/Drivers & OS & & & \multicolumn{1}{c|}{} & & SI &\\
   \hline    
    \rowcolor{Gray}
    \cellcolor{white} & Shadowcrypt~\cite{he2014shadowcrypt}                  &          &      &      \yes      &  \yes    &               & \yes     &           &   &    &\yes\\
    
    &Browser-based~\cite{ye2005trusted}             &          &       & \yes         & \yes     &               &       &           & \yesNope &   &\yes\\
    \rowcolor{Gray}
       \cellcolor{white} & InContext~\cite{Overshadow}                  &          &      &            & \yes     &               & \yes     &           &   &    &\yes\\
    & Overshadow~\cite{Overshadow}                  &          &      &            & \yes     &               &       &           &   &  &  \\
    \rowcolor{Gray}
    \cellcolor{white}&Virtual ghost~\cite{criswell2014virtual}      &          &      &          & \yes     &               &       &           &   &  & \\
    &TrustVisor~\cite{mccune2010trustvisor}          &          &      &          & \yes     &               &       &           &   &  & \\
    \rowcolor{Gray}
    \cellcolor{white}&Inktag~\cite{hofmann2013inktag}              &          &      &          & \yes     &               &       &           &   &   & \\
    &Splitting interfaces~\cite{ta2006splitting}  &          &      &          & \yes     & \yes             &       &           & \yes &  & \\
    \rowcolor{Gray}
    \cellcolor{white}&$SP^3$~\cite{yang2008using}                  &          &      &          & \yes     & \yes             &       &           &   &  & \\
    &SGX IO~\cite{weiser2017sgxio}                   & \yes     &      & \yes     & \yes    & \yes             &       &           &   &  & \\
    \rowcolor{Gray}
    \cellcolor{white}\parbox[t]{1mm}{\multirow{-11}{*}{\rotatebox[origin=c]{90}{\textbf{Hypervisor/OS-based}}}}  \ldelim\{{-11}{0mm}[] & SchrodinText~\cite{sani2017schrodintext}     & \yes     &   &      & \yes     &               &       &           & \yes &  &  \\
    &BASTION-SGX~\cite{BASTION-SGX}                 & \yes     &       &          &      & \yes             &       &           &   &  &\yes\\
    \rowcolor{Gray}
    \cellcolor{white}&Slice~\cite{azab2011sice}                     & \yesNope &       &          &      &               &       &           &   &  & \\
    &TrustOTP~\cite{sun2015trustotp}                 & \yes     &       &          &      & \yes             &       &           & \yesNope &  &\yes\\
    \rowcolor{Gray}
    \cellcolor{white}&VeriUI~\cite{liu2014veriui}                     & \yes     &   & \yes         &      & \yesNope         &       &           & \yesNope &  & \\
    &AdAttester~\cite{li2015adattester}             & \yes     &   & \yes         &      &               &   & \yesNope     & \yesNope &  & \\
    \rowcolor{Gray}
    \cellcolor{white}&TruZ-Droid~\cite{ying2018truz}                 & \yes     &   & \yes         &      & \yes             &       &           & \yesNope &  &\yes\\
    &TrustUI~\cite{li2014building}                 & \yes     &   & \yesNope     &      &               &       & \yesNope         & \yesNope &  &\yes\\
    \rowcolor{Gray}
    \cellcolor{white}&VButton~\cite{li2018vbutton}                 & \yes     &   & \yes     &      & \yesNope             &       & \yes         & \yes &  & \\
    &CARMA~\cite{vasudevan2012carma}                 & \yes     & \yes     &          &      &               &       &           &   & \yes & \\
    \rowcolor{Gray}
    \cellcolor{white}&\textsc{ProximiTee}~\cite{dhar2018proximitee}&\yes         & \yes  & \yesNope     &      & \yes             &       &           &   &\yes &\yes\\
     \cellcolor{white}\parbox[t]{3mm}{\multirow{-13}{*}{\rotatebox[origin=c]{90}{\textbf{TEE-based}}}}  \ldelim\{{-13}{0mm}[] & Fidelius~\cite{Fidelius}                        & \yes     & \yes  & \yes         &      & \yes             &       &           & \yesNope &   &  \\
    \rowcolor{Gray}
    \cellcolor{white}&FPGA-based~\cite{brandon2017trusted}         &          & \yes  &          &      & \yes             &       &           & \yes &   & \\
    &IntegriKey~\cite{IntegriKey}                 &          & \yes  & \yesNope     &      & \yesNope         &      &          &  & \yes &\yes\\ 
    \rowcolor{Gray}
    \cellcolor{white} \cellcolor{white}\parbox[t]{5mm}{\multirow{-6}{*}{\rotatebox[origin=c]{90}{\textbf{External HW}}}}  \ldelim\{{-6}{0mm}[] &Terra~\cite{garfinkel2003terra}                 &          & \yes  & \yesNope     &      &              &       &           &   &  & \\ 
    \\[-1em]
    \rowcolor{white}
    \cellcolor{white}&\textbf{\name}                    &          & \yes  &          &      & \yes             & \yes     & \yes         & \yes & \yes & \yes\\
    \hline
    \multicolumn{12}{c}{\multirow{2}{*}{\yes~requires/supports \hspace{1cm} \yesNope ~partially requires/supports}} \\
  \end{tabular}
  }
  \caption{\textbf{Summary of existing trusted path solutions} by their trust assumptions, security features, and usability. Note that a lower trust assumption, a high number of security features and high usability are desired from a generic trusted path solution. SI stands for security indicator, while PnP stands for plug and play capability. The table also categorizes the trust assumptions, IO security features and usability in-terms of the required security and functional properties that we list in Section~\ref{sec:problemStatement:goals}).}
  \label{tab:relatedWorks}
\end{table*}


\section{Prototype Evaluation}
\label{sec:eval}


\begin{table}[h]
\scriptsize
\centering
\begin{tabular}{l | c}
\textbf{Operation} & \textbf{Average time} \\\hline
Detecting mouse pointer $(A)$ & 1.76 ms \\
Detection QR code $(B)$ & 23 ms\\
Decoding QR code + Overlay $(C)$ & 6 ms\\
Effective display latency $(A+B+C)$ & 30.76 ms \\
Mouse latency & 250 $\mu$s\\
Keyboard latency & 170 $\mu$s\\\hline
\end{tabular} 
\caption{\textbf{\device performance}. The table shows the latency corresponding to a number of \name prototype operations.}
\spacesave
\label{tab:performance}
\end{table}

%\subsection{Performance}
%\label{sec:eval:performance}

We evaluate the performance of our prototype by measuring the overheads introduced by \name to the system and whether they influence the user's interaction. Initially, we measure the default latency introduced by \device when the user interacts with applications that do not require protection. Table~\ref{tab:performance} provides the relevant latencies.
The delay in forwarding keystrokes is $170\ \mu s$ and frames is $30.76\ ms$. This allows the \device to achieve the maximum display frame rate of $32.5$ per second. However, an optimized implementation of the technique to encode information in the HDMI frame would reduce significantly the processing time of a frame and increase further the frame rate as a result.

Our prototype of \name does not require the user to install any additional software in her machine to facilitate the communication between the remote server and the \device. Instead, the \device communicates with the remote server by using the host as an untrusted transporter. Therefore, we start by measuring the delay of sending data from the device to the host and vice versa:

\myparagraph{\device $\rightarrow$ host} The \device transmits data (encrypted) to the host by simulating keystrokes. In our system \device sends the keystrokes in a chunk of $256$ bytes of data to the host. The keystroke has an average latency of $5\ ms$.  

\myparagraph{Host $\rightarrow$ \device} The host sends data to the device by encoding them into the HDMI frame. The QR-code is generated locally in the browser and displayed on the screen. For a specification of a form with two/four elements QR-code generation takes $23\ ms$. The \device detects the QR-code, decodes it, and creates the overlay. This process takes $6\ ms$ for the same form considered previously.
 
\name introduces the following delays in web applications:

\myparagraph{Initial Page Load} First time the user visits a web page that employs \name, the remote server and the \device should exchange a cryptographic key to protect the communication. This step requires only one additional \texttt{xmlHttpRequest} to the server therefore the delay is relatively low. Initially, the browser encodes server's public key into a QR-code that is decoded by the \device, which sends the response to the server by simulating the keystrokes.

\myparagraph{Frame processing for mouse} \device processes every frame of the host for pointer detection. This takes $1.76 ms$, which does not impact the frame rate. \red{Note that the B101 HDMI to CSI board that we use to intercept HDMI, has a hardware limit of 25 frames at 1080p resolution.}

\myparagraph{Keystroke latency} The \device intercepts all user's keystrokes and forwards them to the host or renders in the screen. When rendering on the screen, the latency is $170\ \mu s$.

\myparagraph{Cursor latency} Similarly to keystrokes, the \device intercepts mouse events also. However, the latency of event forwarding is $250\ \mu s$.


%Key exchange takes around $200$ ms. Frame rate $20-24$ fps. Mouse/keyboard latency \textless$10\ ms$.

%\subsection{\red{Security Evaluation}}
%\label{sec:eval:sec}

\begin{table}[!htpb]
\scriptsize
\centering
\begin{tabular}{c |  l | c}
\multicolumn{2}{c|}{\textbf{Projects}} & \textbf{LOC/Binary size} \\\hline
%&\multicolumn{2}{c}{\textbf{Browsers}}\\\hline
\rowcolor{Gray}&Chromium (Google Chrome)~\cite{chromium_2019} &  $25,163,547$\\
\rowcolor{Gray}\multirow{-2}{*}{Browser} &Mozilla Firefox~\cite{mozilla_2019} & $20,928,358$\\
\multirow{2}{*}{JS Engine}&Chrome V8~\cite{V8} & $2,009,183$\\
&Firefox SpiderMonkey~\cite{spiderMonkey} & $2,908,550$\\
\rowcolor{Gray}&Ubuntu 18.10 (Debian) & $1.9$ GB\\
\rowcolor{Gray}\multirow{-2}{*}{OS}&Manjaro Linux 15.0.4 (Arch) & $2$ GB\\
\multirow{4}{*}{\textbf{\device}}&HDMI interceptor + overlay & $1,911$\\ 
&USB stack & $893$\\
&Crypto stack & $3,500$\\ 
&RPi tiny core Linux & $16$ MB \\\hline
\end{tabular} 
\caption{\red{\textbf{Comparisons of \name TCB}. }}
\spacesave
\label{tab:loc}
\end{table}


\red{\myparagraph{TCB comparison} In Table~\ref{tab:loc}, we provide the TCB of \device with respect to some of the most popular open-source browsers and JavaScript interpreter engines. All of the codes are measured with the \texttt{cloc} open-source code line counting tool. The table shows that \name has significantly lower TCB compared to the browsers and JS engines. Hence \name has a smaller attack surface.}

%\red{\myparagraph{Effectiveness of lightbox} Lightbox is an existing technique that is evaluated in the literature. Huang et al.~\cite{huang2012clickjacking} provides a comprehensive user study of several user attention focusing mechanisms. The lightbox is effective $98\%$ of the time while the freezing is effective in $97\%$ time. For more details of the user study, refer to Table 2 in~\cite{huang2012clickjacking}. We assume that similar result should be expected in \name due to the similarity of the application space (web applications).}

